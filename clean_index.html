<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Pile Cap Design - Step by Step</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=JetBrains+Mono:wght@400;500&display=swap" rel="stylesheet">
    <script src="https://cdn.plot.ly/plotly-latest.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
            line-height: 1.6;
            color: #2c3e50;
            background: #f8f9fa;
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            border-radius: 8px;
            border: 1px solid #e1e8ed;
            box-shadow: 0 2px 8px rgba(0,0,0,0.08);
            overflow: hidden;
        }

        .header {
            background: #1a365d;
            color: white;
            padding: 24px 30px;
            text-align: center;
            border-bottom: 3px solid #2a69ac;
        }

        .header h1 {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
            font-size: 2.2rem;
            margin-bottom: 8px;
            font-weight: 700;
            letter-spacing: -0.025em;
        }

        .header p {
            opacity: 0.9;
            font-size: 1.1rem;
            font-weight: 400;
        }

        .main-content {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 0;
            min-height: 80vh;
        }

        .input-section {
            padding: 30px;
            border-right: 1px solid #e1e8ed;
            background: #fafbfc;
            overflow-y: auto;
            max-height: 80vh;
        }

        .visualization-section {
            padding: 30px;
            background: white;
            display: flex;
            flex-direction: column;
        }

        .step {
            background: white;
            border: 1px solid #e1e8ed;
            border-radius: 8px;
            margin-bottom: 20px;
            overflow: hidden;
            box-shadow: 0 1px 3px rgba(0,0,0,0.04);
            transition: box-shadow 0.2s ease;
        }

        .step:hover {
            box-shadow: 0 2px 8px rgba(0,0,0,0.08);
        }

        .step-header {
            background: #f1f5f9;
            padding: 16px 20px;
            border-bottom: 1px solid #e1e8ed;
            cursor: pointer;
            display: flex;
            justify-content: space-between;
            align-items: center;
            user-select: none;
        }

        .step-header h3 {
            font-size: 1.1rem;
            font-weight: 600;
            color: #1a365d;
            margin: 0;
        }

        .step-number {
            background: #1a365d;
            color: white;
            width: 28px;
            height: 28px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 600;
            font-size: 0.9rem;
        }

        .step-content {
            padding: 20px;
            display: none;
        }

        .step.active .step-content {
            display: block;
        }

        .form-group {
            margin-bottom: 16px;
        }

        .form-row {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 16px;
            margin-bottom: 16px;
        }

        .form-row.single {
            grid-template-columns: 1fr;
        }

        label {
            display: block;
            margin-bottom: 6px;
            font-weight: 500;
            color: #374151;
            font-size: 0.9rem;
        }

        input[type="number"], select {
            width: 100%;
            padding: 10px 12px;
            border: 1px solid #d1d5db;
            border-radius: 6px;
            font-size: 0.9rem;
            transition: border-color 0.2s ease, box-shadow 0.2s ease;
            background: white;
        }

        input[type="number"]:focus, select:focus {
            outline: none;
            border-color: #3b82f6;
            box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.1);
        }

        .unit {
            color: #6b7280;
            font-size: 0.85rem;
            margin-left: 4px;
        }

        .description {
            background: #f0f9ff;
            border: 1px solid #bae6fd;
            border-radius: 6px;
            padding: 16px;
            margin-bottom: 20px;
        }

        .description h3 {
            color: #0369a1;
            margin-bottom: 8px;
            font-size: 1rem;
            font-weight: 600;
        }

        .description p {
            color: #075985;
            font-size: 0.9rem;
            line-height: 1.5;
            margin: 0;
        }

        .controls {
            display: flex;
            gap: 8px;
            margin-bottom: 16px;
            flex-wrap: wrap;
        }

        .btn {
            padding: 8px 16px;
            border: 1px solid #d1d5db;
            border-radius: 6px;
            background: white;
            color: #374151;
            font-size: 0.85rem;
            cursor: pointer;
            transition: all 0.2s ease;
            font-weight: 500;
        }

        .btn:hover {
            background: #f3f4f6;
            border-color: #9ca3af;
        }

        .btn.primary {
            background: #1a365d;
            color: white;
            border-color: #1a365d;
        }

        .btn.primary:hover {
            background: #2a4a6b;
        }

        #plot3d {
            width: 100%;
            height: 500px;
            border: 1px solid #e1e8ed;
            border-radius: 6px;
            background: white;
        }

        .results-section {
            margin-top: 20px;
        }

        .grid-2 {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 16px;
        }

        .grid-3 {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 16px;
        }

        .grid-4 {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 16px;
        }

        @media (max-width: 1024px) {
            .main-content {
                grid-template-columns: 1fr;
            }
            
            .input-section {
                border-right: none;
                border-bottom: 1px solid #e1e8ed;
                max-height: none;
            }
        }

        @media (max-width: 768px) {
            .form-row, .grid-2, .grid-3, .grid-4 {
                grid-template-columns: 1fr;
            }
            
            .container {
                margin: 10px;
                border-radius: 4px;
            }
            
            .header {
                padding: 20px;
            }
            
            .header h1 {
                font-size: 1.8rem;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>Pile Cap Design Calculator</h1>
            <p>Professional step-by-step structural analysis and 3D visualization</p>
        </div>

        <div class="main-content">
            <div class="input-section">
                <!-- Step 1: Material Properties -->
                <div class="step active">
                    <div class="step-header" onclick="toggleStep(this)">
                        <h3>Step 1: Material Properties</h3>
                        <div class="step-number">1</div>
                    </div>
                    <div class="step-content">
                        <div class="description">
                            <h3>Material Specifications</h3>
                            <p>Define the material properties for concrete and steel reinforcement used in the pile cap design.</p>
                        </div>
                        
                        <div class="form-row">
                            <div class="form-group">
                                <label for="concrete_fc">Concrete Strength f'c <span class="unit">(ksi)</span></label>
                                <input type="number" id="concrete_fc" value="5.5" step="0.1" min="3" max="12">
                            </div>
                            <div class="form-group">
                                <label for="steel_fy">Steel Yield Strength fy <span class="unit">(ksi)</span></label>
                                <input type="number" id="steel_fy" value="60" step="1" min="40" max="80">
                            </div>
                        </div>
                        
                        <div class="form-row single">
                            <div class="form-group">
                                <label for="cover">Concrete Cover <span class="unit">(inches)</span></label>
                                <input type="number" id="cover" value="4.0" step="0.5" min="2" max="6">
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Step 2: Column Dimensions & Loading -->
                <div class="step">
                    <div class="step-header" onclick="toggleStep(this)">
                        <h3>Step 2: Column Dimensions & Loading</h3>
                        <div class="step-number">2</div>
                    </div>
                    <div class="step-content">
                        <div class="description">
                            <h3>Column Configuration</h3>
                            <p>Specify the column dimensions and eccentricity values for the pile cap design analysis.</p>
                        </div>
                        
                        <div class="form-row">
                            <div class="form-group">
                                <label for="column_x">Column Width (X-direction) <span class="unit">(ft)</span></label>
                                <input type="number" id="column_x" value="14.00" step="0.25" min="8" max="20">
                            </div>
                            <div class="form-group">
                                <label for="column_y">Column Length (Y-direction) <span class="unit">(ft)</span></label>
                                <input type="number" id="column_y" value="9.00" step="0.25" min="8" max="20">
                            </div>
                        </div>
                        
                        <div class="form-row">
                            <div class="form-group">
                                <label for="ecc_x">Eccentricity X <span class="unit">(ft)</span></label>
                                <input type="number" id="ecc_x" value="0" step="0.1" min="-5" max="5">
                            </div>
                            <div class="form-group">
                                <label for="ecc_y">Eccentricity Y <span class="unit">(ft)</span></label>
                                <input type="number" id="ecc_y" value="0" step="0.1" min="-5" max="5">
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Step 3: Footing Dimensions -->
                <div class="step">
                    <div class="step-header" onclick="toggleStep(this)">
                        <h3>Step 3: Footing Dimensions</h3>
                        <div class="step-number">3</div>
                    </div>
                    <div class="step-content">
                        <div class="description">
                            <h3>Footing Geometry</h3>
                            <p>Define the pile cap thickness, pile embedment depth, and edge distance (overhang) from outer piles.</p>
                        </div>
                        
                        <div class="form-row">
                            <div class="form-group">
                                <label for="footing_thickness">Footing Thickness <span class="unit">(ft)</span></label>
                                <input type="number" id="footing_thickness" value="9" step="0.5" min="3" max="15">
                            </div>
                            <div class="form-group">
                                <label for="pile_embedment">Pile Embedment <span class="unit">(ft)</span></label>
                                <input type="number" id="pile_embedment" value="12" step="1" min="6" max="24">
                            </div>
                        </div>
                        
                        <div class="form-row single">
                            <div class="form-group">
                                <label for="pile_overhang">Pile Overhang <span class="unit">(inches)</span></label>
                                <input type="number" id="pile_overhang" value="19.5" step="0.5" min="12" max="36">
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Step 4: Site Conditions -->
                <div class="step">
                    <div class="step-header" onclick="toggleStep(this)">
                        <h3>Step 4: Site Conditions</h3>
                        <div class="step-number">4</div>
                    </div>
                    <div class="step-content">
                        <div class="description">
                            <h3>Site Elevations & Soil</h3>
                            <p>Set the ground elevation, footing top elevation, water table level, and soil unit weight for the analysis.</p>
                        </div>
                        
                        <div class="form-row">
                            <div class="form-group">
                                <label for="ground_elevation">Ground Elevation <span class="unit">(ft)</span></label>
                                <input type="number" id="ground_elevation" value="73.4" step="0.1" min="0" max="200">
                            </div>
                            <div class="form-group">
                                <label for="footing_top_elevation">Footing Top Elevation <span class="unit">(ft)</span></label>
                                <input type="number" id="footing_top_elevation" value="70.4" step="0.1" min="0" max="200">
                            </div>
                        </div>
                        
                        <div class="form-row">
                            <div class="form-group">
                                <label for="water_elevation">Water Table Elevation <span class="unit">(ft)</span></label>
                                <input type="number" id="water_elevation" value="68.0" step="0.1" min="0" max="200">
                            </div>
                            <div class="form-group">
                                <label for="soil_weight">Soil Unit Weight <span class="unit">(kcf)</span></label>
                                <input type="number" id="soil_weight" value="0.115" step="0.001" min="0.1" max="0.2">
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Step 5: Pile Layout -->
                <div class="step">
                    <div class="step-header" onclick="toggleStep(this)">
                        <h3>Step 5: Pile Layout</h3>
                        <div class="step-number">5</div>
                    </div>
                    <div class="step-content">
                        <div class="description">
                            <h3>Pile Configuration</h3>
                            <p>Configure the pile layout including number of piles, spacing between piles, and pile diameter.</p>
                        </div>
                        
                        <div class="form-row">
                            <div class="form-group">
                                <label for="pile_no_x">Number of Piles (X-direction)</label>
                                <input type="number" id="pile_no_x" value="8" step="1" min="2" max="12">
                            </div>
                            <div class="form-group">
                                <label for="pile_no_y">Number of Piles (Y-direction)</label>
                                <input type="number" id="pile_no_y" value="6" step="1" min="2" max="12">
                            </div>
                        </div>
                        
                        <div class="form-row">
                            <div class="form-group">
                                <label for="pile_spacing_x">Pile Spacing X <span class="unit">(ft)</span></label>
                                <input type="number" id="pile_spacing_x" value="4.15" step="0.05" min="2.5" max="8">
                            </div>
                            <div class="form-group">
                                <label for="pile_spacing_y">Pile Spacing Y <span class="unit">(ft)</span></label>
                                <input type="number" id="pile_spacing_y" value="3.75" step="0.05" min="2.5" max="8">
                            </div>
                        </div>
                        
                        <div class="form-row single">
                            <div class="form-group">
                                <label for="pile_diameter">Pile Diameter <span class="unit">(inches)</span></label>
                                <input type="number" id="pile_diameter" value="15" step="1" min="10" max="30">
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Step 6: Pile Capacity -->
                <div class="step">
                    <div class="step-header" onclick="toggleStep(this)">
                        <h3>Step 6: Pile Capacity</h3>
                        <div class="step-number">6</div>
                    </div>
                    <div class="step-content">
                        <div class="description">
                            <h3>Pile Structural Capacity</h3>
                            <p>Define the bearing capacity and side friction resistance values for the pile foundation system.</p>
                        </div>
                        
                        <div class="form-row">
                            <div class="form-group">
                                <label for="bearing_capacity">Bearing Capacity <span class="unit">(kips)</span></label>
                                <input type="number" id="bearing_capacity" value="270" step="10" min="100" max="1000">
                            </div>
                            <div class="form-group">
                                <label for="side_friction">Side Friction <span class="unit">(kips)</span></label>
                                <input type="number" id="side_friction" value="270" step="10" min="100" max="1000">
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="visualization-section">
                <div class="controls">
                    <button class="btn primary" onclick="update3DView()">Update 3D View</button>
                    <button class="btn" onclick="resetView()">Reset View</button>
                    <button class="btn" onclick="topView()">Top View</button>
                    <button class="btn" onclick="sideView()">Side View</button>
                </div>
                
                <div id="plot3d"></div>
            </div>
        </div>
    </div>

    <script>
        // Default load cases data
        const defaultLoadCases = [
            [1, 1.00, 230, 233, 6764, 10600, 12710],
            [2, 1.00, -230, 233, 4876, 10590, 10160],
            [3, 1.00, 0, 143, 8113, 6958, 1782],
            [4, 1.00, -217, 143, 4611, 6943, 15900],
            [5, 1.00, 125, -322, 4876, 14160, 6856],
            [6, 1.00, 125, 322, 6764, 14120, 7270],
            [7, 1.00, 125, 322, 4864, 14120, 6853],
            [8, 1.00, 125, -322, 6764, 14170, 7270],
            [9, 1.00, -25, 180, 7977, 8880, 15700]
        ];

        let loadCasesData = [];
        let pileCoordinates = [];
        let analysisResultsData = {};

        // Interactive 3D Visualization with Plotly
        function draw3DView() {
            try {
                // Get input values with error handling
                const pileNoX = parseInt(document.getElementById('pile_no_x')?.value || 8);
                const pileNoY = parseInt(document.getElementById('pile_no_y')?.value || 6);
                const pileSpacingX = parseFloat(document.getElementById('pile_spacing_x')?.value || 4.15);
                const pileSpacingY = parseFloat(document.getElementById('pile_spacing_y')?.value || 3.75);
                const pileDiameter = parseFloat(document.getElementById('pile_diameter')?.value || 15);
                const footingThickness = parseFloat(document.getElementById('footing_thickness')?.value || 9);
                const pileEmbedment = parseFloat(document.getElementById('pile_embedment')?.value || 12);
                const pileOverhang = parseFloat(document.getElementById('pile_overhang')?.value || 19.5);
                const groundElevation = parseFloat(document.getElementById('ground_elevation')?.value || 73.4);
                const footingTopElevation = parseFloat(document.getElementById('footing_top_elevation')?.value || 70.4);
                const waterElevation = parseFloat(document.getElementById('water_elevation')?.value || 68.0);
                const columnX = parseFloat(document.getElementById('column_x')?.value || 14.00);
                const columnY = parseFloat(document.getElementById('column_y')?.value || 9.00);
                
                // Calculate dimensions
                const footingBottomElevation = footingTopElevation - footingThickness;
                const pileTopElevation = footingBottomElevation;
                const pileLength = pileEmbedment + footingThickness;
                const pileBottomElevation = pileTopElevation - pileLength;
                const footingWidth = (pileNoX - 1) * pileSpacingX + 2 * pileOverhang;
                const footingLength = (pileNoY - 1) * pileSpacingY + 2 * pileOverhang;
                const columnHeight = 9;
                const columnTopElevation = footingTopElevation + columnHeight;
                
                const data = [];
                
                // Simple box creation function
                function createBox(xMin, xMax, yMin, yMax, zMin, zMax, color, opacity, name, hoverText) {
                    const vertices = [
                        [xMin, yMin, zMin], [xMax, yMin, zMin], [xMax, yMax, zMin], [xMin, yMax, zMin],
                        [xMin, yMin, zMax], [xMax, yMin, zMax], [xMax, yMax, zMax], [xMin, yMax, zMax]
                    ];
                    
                    const x = vertices.map(v => v[0]);
                    const y = vertices.map(v => v[1]);
                    const z = vertices.map(v => v[2]);
                    
                    const faces = [
                        [0, 1, 2], [0, 2, 3], [4, 6, 5], [4, 7, 6],
                        [0, 4, 5], [0, 5, 1], [2, 6, 7], [2, 7, 3],
                        [0, 3, 7], [0, 7, 4], [1, 5, 6], [1, 6, 2]
                    ];
                    
                    return {
                        x: x, y: y, z: z,
                        i: faces.map(face => face[0]),
                        j: faces.map(face => face[1]),
                        k: faces.map(face => face[2]),
                        type: 'mesh3d',
                        color: color,
                        opacity: opacity,
                        showlegend: false,
                        hovertemplate: hoverText,
                        name: name
                    };
                }
                
                // Create pile coordinates with correct spacing
                const pileCoords = [];
                const totalWidthPiles = (pileNoX - 1) * pileSpacingX;
                const totalLengthPiles = (pileNoY - 1) * pileSpacingY;
                const startX = -totalWidthPiles / 2;
                const startY = -totalLengthPiles / 2;
                
                for (let i = 0; i < pileNoX; i++) {
                    for (let j = 0; j < pileNoY; j++) {
                        const x = startX + i * pileSpacingX;
                        const y = startY + j * pileSpacingY;
                        pileCoords.push({ x: x, y: y, id: `${String.fromCharCode(65 + i)}${j + 1}` });
                    }
                }
                
                // Create piles
                pileCoords.forEach((pile, index) => {
                    const pileRadius = (pileDiameter / 12) / 2;
                    const pileBox = createBox(
                        pile.x - pileRadius, pile.x + pileRadius,
                        pile.y - pileRadius, pile.y + pileRadius,
                        pileBottomElevation, pileTopElevation,
                        '#CD853F', 0.9, `Pile ${pile.id}`,
                        `Pile ${pile.id}<br>Position: (${pile.x.toFixed(2)}', ${pile.y.toFixed(2)}')<br>Diameter: ${pileDiameter}"<br>Length: ${pileLength.toFixed(1)}'<extra></extra>`
                    );
                    data.push(pileBox);
                });
                
                // Create pile cap
                const footingBox = createBox(
                    -footingWidth/2, footingWidth/2,
                    -footingLength/2, footingLength/2,
                    footingBottomElevation, footingTopElevation,
                    '#B0C4DE', 0.8, 'Pile Cap',
                    `Pile Cap<br>Size: ${footingWidth.toFixed(1)}' × ${footingLength.toFixed(1)}' × ${footingThickness.toFixed(1)}'<br>Layout: ${pileNoX} × ${pileNoY} piles<extra></extra>`
                );
                data.push(footingBox);
                
                // Create column
                const columnBox = createBox(
                    -columnX/2, columnX/2,
                    -columnY/2, columnY/2,
                    footingTopElevation, columnTopElevation,
                    '#4682B4', 0.9, 'Column',
                    `Column<br>Size: ${columnX.toFixed(1)}' × ${columnY.toFixed(1)}' × 9.0'<extra></extra>`
                );
                data.push(columnBox);
                
                // Add water layer if needed
                if (waterElevation > pileBottomElevation) {
                    const waterSize = Math.max(footingWidth, footingLength) * 1.5;
                    const waterTop = Math.min(waterElevation, footingTopElevation - 0.1);
                    const waterBox = createBox(
                        -waterSize/2, waterSize/2,
                        -waterSize/2, waterSize/2,
                        pileBottomElevation, waterTop,
                        '#00CED1', 0.3, 'Water',
                        `Water Table<br>Elevation: ${waterElevation.toFixed(1)}'<extra></extra>`
                    );
                    data.push(waterBox);
                }
                
                // Add soil layer
                const soilSize = Math.max(footingWidth, footingLength) * 1.8;
                const soilBox = createBox(
                    -soilSize/2, soilSize/2,
                    -soilSize/2, soilSize/2,
                    pileBottomElevation, groundElevation,
                    '#DEB887', 0.25, 'Ground/Soil',
                    `Ground/Soil Layer<br>Ground Elevation: ${groundElevation.toFixed(1)}'<extra></extra>`
                );
                data.push(soilBox);
                
                const layout = {
                    scene: {
                        xaxis: { title: 'X Distance (ft)', showgrid: true, gridcolor: '#E0E0E0' },
                        yaxis: { title: 'Y Distance (ft)', showgrid: true, gridcolor: '#E0E0E0' },
                        zaxis: { title: 'Elevation (ft)', showgrid: true, gridcolor: '#E0E0E0' },
                        camera: { eye: { x: 1.8, y: 1.8, z: 1.5 } },
                        aspectratio: { x: 1, y: 1, z: 0.8 }
                    },
                    margin: { l: 0, r: 0, b: 0, t: 40 },
                    title: {
                        text: `Pile Cap 3D View - ${pileNoX}×${pileNoY} Piles @ ${pileSpacingX.toFixed(2)}'×${pileSpacingY.toFixed(2)}' O.C.`,
                        font: { size: 16, color: '#2c3e50' }
                    },
                    showlegend: false,
                    hovermode: 'closest'
                };
                
                const config = {
                    displayModeBar: true,
                    displaylogo: false,
                    responsive: true
                };
                
                Plotly.newPlot('plot3d', data, layout, config);
                
            } catch (error) {
                console.error('Error in draw3DView:', error);
            }
        }

        // View control functions
        function resetView() {
            const update = {
                'scene.camera.eye': { x: 1.8, y: 1.8, z: 1.5 },
                'scene.camera.center': { x: 0, y: 0, z: 0 }
            };
            Plotly.relayout('plot3d', update);
        }

        function topView() {
            const update = {
                'scene.camera.eye': { x: 0, y: 0, z: 2.5 },
                'scene.camera.center': { x: 0, y: 0, z: 0 }
            };
            Plotly.relayout('plot3d', update);
        }

        function sideView() {
            const update = {
                'scene.camera.eye': { x: 2.5, y: 0, z: 0 },
                'scene.camera.center': { x: 0, y: 0, z: 0 }
            };
            Plotly.relayout('plot3d', update);
        }

        // Function to update 3D view when inputs change
        function update3DView() {
            if (typeof Plotly !== 'undefined') {
                draw3DView();
            }
        }

        // Step toggle functionality
        function toggleStep(header) {
            const step = header.parentElement;
            const allSteps = document.querySelectorAll('.step');
            
            allSteps.forEach(s => s.classList.remove('active'));
            step.classList.add('active');
        }

        // Add event listeners for real-time updates
        document.addEventListener('DOMContentLoaded', function() {
            const allInputs = [
                'concrete_fc', 'steel_fy', 'cover', 'column_x', 'column_y', 'ecc_x', 'ecc_y',
                'footing_thickness', 'pile_embedment', 'pile_overhang', 'ground_elevation',
                'footing_top_elevation', 'water_elevation', 'soil_weight', 'pile_no_x', 'pile_no_y',
                'pile_spacing_x', 'pile_spacing_y', 'pile_diameter', 'bearing_capacity', 'side_friction'
            ];
            
            allInputs.forEach(inputId => {
                const element = document.getElementById(inputId);
                if (element) {
                    element.addEventListener('input', update3DView);
                    element.addEventListener('change', update3DView);
                }
            });

            // Initialize 3D view after a short delay
            setTimeout(update3DView, 500);
        });
    </script>
</body>
</html>
